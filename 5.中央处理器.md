## 运算器

用于实现算术运算（如：加减乘除）、逻辑运算(如：与或非)

主要由算术逻辑单元(ALU), 暂存寄存器, 累加寄存器(ACC), 通用寄存器, 程序状态字寄存器(PSW), 移位器, 计数器(CT)等组成

1. 算术逻辑单元：主要功能是进行算术/逻辑运算。
2. 通用寄存器组：如AX、BX、CX、DX、SP等，用于存放操作数（包括源操作数、目的操作数及中间结果）和各种地址信息等。SP是堆栈指针，用于指示栈顶的地址。
3. 暂存寄存器：用于暂存从主存读来的数据，这个数据不能存放在通用寄存器中，否则会破坏其原有内容。
4. 累加寄存器：它是一个通用寄存器，用于暂时存放ALU运算的结果信息，用于实现加法运算。
5. 程序状态字寄存器：保留由算术逻辑运算指令或测试指令的结果而建立的各种状态信息，如溢出标志（OP）、符号标志（SF）、零标志（ZF）、进位标志（CF）等。PSW中的这些位参与并决定微操作的形成。
6. 移位器：对运算结果进行移位运算。
7. 计数器：控制乘除运算的操作步数。

### 转移指令

#### 条件转移指令

执行时, 需要对标志寄存器的内容进行测试, 判断是否满足转移条件

转移指令时, 需要判断是否满足转移条件, 成功PC修改为转移指令的目标地址, 否则自增

#### 无条件转移指令

对于无条件跳转指令, PC值会修改两次, 取指令周期结束后, PC值自动加1, 执行周期中, PC值修改为要跳转到的地址.

#### 通用寄存器

通用寄存器用于存放操作数和各种地址信息等, 其位数与机器字长相等

通用寄存器供用户自由编程, 可以存放数据和地址.

#### 程序状态字寄存器

用于存放程序状态, 保留算数, 逻辑及测试指令的结果状态

对于用户不是透明的

## 控制器

取指令, 分析指令和执行指令, 并产生有关操作控制信号

取指令是自动进行的, 不需要得到相应的指令

### 译码

指令包括操作码字段和地址码字段, 但指令译码器仅对操作码字段进行译码, 借以确定指令的操作功能

## MDR (地址寄存器)

间址周期的作用是取操作数的有效地址, 因此间址周期结束后, MDR中的内容是操作数地址

## 程序计数器(PC)

>[疑问]

某计算机的主存空间为4GB, 字长为32位, 按字节编址, 程序计数器的位数为30位

程序计数器给出下一条指令的芳村地址(指令在内存中的地址), 取决于存储器的字数(4GB / 32 位 = 2^30)

1. 指令总是根据程序计数器从主存中读出

## 中断

机器处于开中断状态, 在每条指令执行结束时都可能被外部中断打断

## 时钟周期

计算机操作的最小时间单位, 由计算机主频确定, 主频的倒数, 一个时钟周期有一个工作脉冲

## 工作脉冲

控制器的最小时间单位, 起定时触发作用

## 指令周期

CPU从主存中每取出一条指令所需的全部时间成为指令周期

## 机器周期

一个机器周期包含若干时钟周期

1. 机器周期通常由存取周期确定

## 存取周期

进行两次独立的存储器操作所需的最小间隔时间

## 间址

指令的间址分为一次间址, 两次间址, 和多次间址, 他们的操作是不同的.6

## 指令字长

指令字长一般都取存储字长的整数倍, 若指令字长等于存储字长的2倍, 则需要2次访存, 取指周期等于机器周期的2倍

## 数据通路的功能和基本结构

### ALU的连接

ALU是一个组合逻辑电路, 因此运算过程中必须保持两个输入端的内容不变, 又由于CPU内部采用单总线结构, 因此为了得到两个不同的操作数, ALU的一个输入端与总线相连, 另一个输入端需通过一个寄存器与总线相连. 此外, ALU的输出端也不能直接与内部总线相连, 否则其输出又会通过总线反馈到输入端, 影响运算结果, 因此输出端需要通过一个寄存器(用来暂存结果)与总线相连

### 内部总线

* 采用内部总线: 结构简单, 容易实现, 性能较低, 存在较多冲突
* 不采用内部总线: 结构复杂, 硬件量大, 不容易实现, 性能高, 基本不存在数据冲突现象.

### 读写控制信号

决定了是从存储器读还是向存储器写

## 控制器的功能和工作原理

微程序控制器采用**存储程序**的原理

## 流水线

时钟周期应以各功能段最长执行时间为准

### 流水线分类

* 部件功能级, 处理机级和处理机间级流水线
* 单功能多功能
* 动态和静态
* 线性非线性

### 影响流水线的因素

资源冲突(结构相关)和相关问题

#### 相关问题

* 数据冲突
  * 暂停一至几个时钟周期(硬件阻塞stall和软件插入"NOP"指令)
  * 专用通路, 数据旁路技术(直接使用ALU计算结果)
  * 指令编译优化
* 控制冲突
  * 分支预测(静态预测和动态预测)
  * 预取转移成功和不成功方向上的指令
  * 加快和提前形成条件码
  * 提高转移方向的猜准率
