## 3.只读存储器

### 各种ROM

RAM 易失性
ROM 非易失性

MROM (Mask Read-Only Memory) 掩模式只读存储器

PROM (Programmable Read-Only Memory) 可编程式只读存储器

EPROM (Erasable Programmable Read-Only Memory) 可擦除可编程只读存储器

UVEPROM（ultraviolet rays）——用紫外线照射8~20分钟，擦除所有信息

EEPROM（也常记为E2PROM，第一个E是Electrically）——可用“电擦除”的方式，擦除特定的字

    FlashMemory——闪速存储器

    SSD（SolidStateDrives）——固态硬盘, 由控制单元+存储单元（Flash芯片）构成，与闪速存储器的核心区别在于控制单元不一样，但存储介质都类似，可进行多次快速擦除重写. 手机辅存也使用Flash芯片，但相比SSD使用的芯片集成度高、功耗低、价格贵4

### 计算机中重要的ROM

CPU的任务：到主存中取指令并执行指令

主板上的BIOS芯片（ROM），存储了“自举装入程序”，负责引导装入操作系统（开机）

断电后，RAM内数据全部丢失

逻辑上，主存由RAM+ROM组成，且二者常统一编址. 我们常说“内存条”就是“主存”，但事实上，主板上的ROM芯片也是“主存”的一部分

## 主存储器与CPU的连接

多款存储芯片与CPU的连接

位扩展 (存储字长变大)
字扩展 (增加存储字数, 利用CPU的取址能力)
字位扩展

数据总线(宽度=存储字长), 尽量保持一致

注意MAR和MDR一般集成在CPU内部

## 双端口RAM和多模块存储器

多核CPU和DRAM存取时间的矛盾(DRAM的恢复时间较长, 破坏性读出)

## Cache

### 局部性原理

空间局部性：在最近的未来要用到的信息(指令和数据)，很可能与现在正在使用的信息在存储空间上是邻近的

时间局部性：在最近的未来要用到的信息，很可能是现在正在使用的信息

将主存的存储空间“分块”，如：每1KB为一块。主存与Cache之间以“块”为单位进行数据交换

### Cache与主存的映射关系

* 全相联: 空间利用充分, 但是查找可能很慢
* 直接映射: 查找最快, 但是存储空间利用不充分, 命中率低
* 组相联: 折中, 综合效果好

n路组相联映射: 每n个Cache行为一组

拆分地址, 查找Cache, 访存

### 替换算法

和采用的映射关系有关

* 随机算法 (RAND,Random)
* 先进先出 (FIFO,FirstInFirstOut)
* 最近最少使用 (每次重置一次计数器)
* 最近不经常使用 (有一个全局计数器, 没有考虑到 时间局部性)

### Cache写策略

写命中

* 全写法
* 写回法

写不命中(非写分配法: 只有读未命中才调入Cache)

* 写分配法 (把主存的块调入Cache, 在Cache中修改, 搭配写回法)
* 非写分配法 (不调入Cache, 搭配全写法)

各级Cache之间常采用**全写法** + **非写分配法**, Cache - 主存之间常采用 **写回法 + 写分配法**

## 页式存储
